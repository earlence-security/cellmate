<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Settings</title>
  <link rel="stylesheet" href="popup.css">
  <style>
    body { margin:0; background:#f9fafb; color:#111827; width:320px; }
    header{
      display:flex; align-items:center; gap:8px;
      padding:10px 12px; border-bottom:1px solid #e5e7eb; background:#fff;
    }
    header h1{ font-size:14px; margin:0; flex:1; }
    #back-btn{ background:transparent; border:none; font-size:14px; cursor:pointer; color:#2563eb; padding:6px 8px; border-radius:6px; }
    main{ padding:12px; display:flex; flex-direction:column; gap:12px; }

    .row{
      display:flex; align-items:center; justify-content:space-between;
      background:#fff; border:1px solid #e5e7eb; border-radius:10px; padding:10px 12px;
    }
    .label{ font-size:14px; }

    /* iOS toggle reused */
    .toggle{ position:relative; width:44px; height:24px; flex:none; }
    .toggle input{ display:none; }
    .slider{ position:absolute; cursor:pointer; inset:0; background:#e5e7eb; border-radius:9999px; transition:background .2s; }
    .slider::before{ content:""; position:absolute; width:20px; height:20px; left:2px; top:2px; background:#fff; border-radius:9999px; transition:transform .2s; box-shadow:0 1px 3px rgba(0,0,0,.2); }
    input:checked + .slider{ background:#34c759; }
    input:checked + .slider::before{ transform:translateX(20px); }

    /* API key card */
    .card{
      background:#fff; border:1px solid #e5e7eb; border-radius:10px; padding:12px;
      display:flex; flex-direction:column; gap:8px;
    }
    .hint{ font-size:13px; color:#6b7280; }
    .row-input{ display:flex; gap:8px; }
    input[type="password"], input[type="text"]{
      flex:1; padding:8px 10px; border:1px solid #e5e7eb; border-radius:8px; font-size:13px;
      background:#fff; color:#111827;
    }
    .btn { background:#2563eb; color:#fff; border:none; border-radius:8px; padding:8px 10px; font-size:13px; cursor:pointer; }
    .btn:hover { background:#1d4ed8; }
    .btn.ghost { background:transparent; color:#374151; border:1px solid #e5e7eb; }
    .btn.ghost:hover{ background:#f3f4f6; }
    .status{ font-size:12px; color:#065f46; background:#ecfdf5; border:1px solid #a7f3d0; padding:6px 8px; border-radius:8px; display:none; }
    .danger { color:#991b1b; background:#fef2f2; border-color:#fecaca; }
  </style>
  <script src="settings.js" defer></script>
</head>
<body>
  <header>
    <button id="back-btn">← Back</button>
    <h1>Settings</h1>
  </header>

  <main>
    <!-- Disallow untrusted toggle -->
    <div class="row">
      <div class="label">Disallow requests to all domains without a policy</div>
      <label class="toggle">
        <input type="checkbox" id="disallow">
        <span class="slider"></span>
      </label>
    </div>

    <!-- API Key block -->
    <div class="card">
      <div class="label">LLM API key</div>
      <div class="hint">
        Provide an API key to receive model suggestions during policy setup.
        Your key is stored locally in the extension’s storage.
      </div>

      <div class="row-input">
        <input type="password" id="apiKeyInput" placeholder="Enter API key…" autocomplete="off">
        <button class="btn" id="setApiKeyBtn">Set</button>
      </div>

      <div style="display:flex; justify-content:flex-end;">
        <button class="btn ghost" id="removeApiKeyBtn">Remove saved API key</button>
      </div>

      <div id="apiStatus" class="status"></div>
    </div>
  </main>
</body>
</html>
