<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Auto-Send Message</title>
  </head>
  <body>
    <h1>Message Sender</h1>
    <input type="text" id="message" placeholder="Type a message..." />
    <p id="response"></p>

    <script>
      const input = document.getElementById("message");
      let timer;

      input.addEventListener("input", () => {
        clearTimeout(timer);
        timer = setTimeout(() => {
          sendMessage(input.value);
        }, 500); // send 500ms after user stops typing
      });

      function sendMessage(message) {
        fetch("http://localhost:3000/submit", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ message }),
        })
          .then((res) => res.json())
          .then((data) => {
            document.getElementById("response").innerText =
              "Server replied: " + data.echo;
          })
          .catch((err) => console.error("Error:", err));
      }
    </script>
  </body>
</html>
